---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`Posts | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main id="main-content" class="max-w-3xl mx-auto w-full px-4">
			<section class="pt-12 pb-6">
				<h1 class="text-2xl font-bold mb-8">All Posts</h1>
				<ul>
					{posts.map((post) => (
						<li class="my-8">
							<a href={`/blog/${post.id}/`} class="text-lg font-medium text-accent decoration-dashed underline-offset-4 hover:underline">
								{post.data.title}
							</a>
							<div class="flex items-center gap-3 mt-1 mb-2">
								<div class="flex items-center gap-2 opacity-80">
									<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0">
										<path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" />
										<path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" />
									</svg>
									<span class="text-sm italic">
										<FormattedDate date={post.data.pubDate} />
									</span>
								</div>
							</div>
							{post.data.description && (
								<p class="opacity-80">{post.data.description}</p>
							)}
						</li>
					))}
				</ul>
			</section>
		</main>
		<Footer />
	</body>
</html>
